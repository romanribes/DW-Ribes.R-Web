@{
	Layout = "~/Shared/Layouts/_Layout.cshtml";
	Page.Title = "Página Principal";

    var db = Database.Open("ChistesMalos");
    var sqlSelect = @"SELECT * FROM chistes INNER JOIN Settings ON chistes.chisteId = Settings.chistesDestacado";

    var chiste = db.QuerySingle(sqlSelect);    
}

@if(chiste != null)
{
    <h1 class="">Chiste del mes</h1>
    <div id="productoDestacadoImagen">
        
    </div>
    <div id="productoDestacadoDetalles">
        <p>@chiste.chiste</p>
        <p class="precio">@chiste.autor</p>
        <p><a href="~/ChisteDetalles/@chiste.chisteID" class="detailsButton">Mas detalles</a></p>
    </div> 
}

@{
    sqlSelect = @"SELECT TOP 4 chisteID,chiste FROM chistes 
                  ORDER BY chisteId DESC";

    var lastchistes = db.Query(sqlSelect);
}

@if(lastchistes.Count() > 0)
{
    <div id="popularProductos">
        <h1>Ultimos Chistes</h1>
        <ul id="popularProductosList">
            @foreach(var item in lastchistes)
            {
                <li>
                    <a href="~/ChisteDetalles/@item.chisteId" class="detailsButton">@item.chiste
                       
                    </a>
                </li>   
            }
        </ul>
    </div>
}
